(()=>{"use strict";var e={551:(e,o,s)=>{var t=s(154),n=s(341),r=s(45),a=s(261);const i=(0,r.v)((0,a.Zr)((e,o)=>({isAuthenticated:!1,user:null,accessToken:null,refreshToken:null,isLoading:!1,error:null,debugOAuth:async()=>{try{if(console.log("\ud83d\udd0d === DIAGN\xd3STICO OAUTH INICIADO ==="),!chrome||!chrome.identity)throw new Error("No se detect\xf3 contexto de extensi\xf3n de Chrome");const e="571791803428-h5qdt3rdtbk3g1p5ut2k8fvioh59h8qp.apps.googleusercontent.com",o=chrome.identity.getRedirectURL("google"),s=o.split("://")[1].split("/")[0];console.log("\ud83d\udccb Configuraci\xf3n detectada:"),console.log("- Extension ID (real):",s),console.log("- Client ID:",e),console.log("- Redirect URI:",o),console.log("- Redirect URI esperado en Google Cloud Console:",`https://${s}.chromiumapp.org/google`);const t="https://accounts.google.com/o/oauth2/v2/auth?"+new URLSearchParams({client_id:e,response_type:"token",redirect_uri:o,scope:"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/documents https://www.googleapis.com/auth/drive.readonly",include_granted_scopes:"true",prompt:"consent",access_type:"online",state:"debug_test_"+Date.now()}).toString();console.log("\ud83d\udd17 Auth URL construida:",t),console.log("\ud83d\ude80 Probando launchWebAuthFlow...");const n=await new Promise((e,o)=>{chrome.identity.launchWebAuthFlow({url:t,interactive:!0},s=>{chrome.runtime.lastError?(console.error("\u274c Error en launchWebAuthFlow:",chrome.runtime.lastError),o(new Error(chrome.runtime.lastError.message||"Error de autorizaci\xf3n"))):s?(console.log("\u2705 Response URL recibida:",s),e(s)):o(new Error("No se recibi\xf3 URL de respuesta"))})}),r=n.split("#")[1];if(r){const o=new URLSearchParams(r),a=o.get("access_token"),i=o.get("error");if(i)return console.error("\u274c Error en OAuth:",i,o.get("error_description")),{success:!1,method:"launchWebAuthFlow",error:`${i}: ${o.get("error_description")||"Error desconocido"}`,extensionId:s,clientId:e,authUrl:t};if(a)return console.log("\u2705 Token obtenido exitosamente"),{success:!0,method:"launchWebAuthFlow",tokenStatus:"obtenido",responseUrl:n,extensionId:s,clientId:e,authUrl:t}}return{success:!1,method:"launchWebAuthFlow",error:"No se pudo extraer token de la respuesta",responseUrl:n,extensionId:s,clientId:e,authUrl:t}}catch(e){return console.error("\u274c Error en debugOAuth:",e),{success:!1,error:e.message,extensionId:"No disponible",clientId:"571791803428-gbl2p0i1sab5jk1dd4g9fs2b7rj51nko.apps.googleusercontent.com"}}},login:async()=>{e({isLoading:!0,error:null});try{if(!chrome||!chrome.identity)throw new Error("Esta funcionalidad solo est\xe1 disponible en extensiones de Chrome");console.log("\ud83d\udd11 Iniciando proceso de autenticaci\xf3n con launchWebAuthFlow...");const s="571791803428-h5qdt3rdtbk3g1p5ut2k8fvioh59h8qp.apps.googleusercontent.com",t=chrome.identity.getRedirectURL("google"),n=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/documents","https://www.googleapis.com/auth/drive.readonly"];console.log("\ud83d\udccb Configuraci\xf3n OAuth:"),console.log("- Redirect URI:",t),console.log("- Client ID:",s),console.log("- Scopes:",n);const r="https://accounts.google.com/o/oauth2/v2/auth?"+new URLSearchParams({client_id:s,response_type:"token",redirect_uri:t,scope:n.join(" "),include_granted_scopes:"true",prompt:"consent",access_type:"online",state:"franbot_auth_"+Date.now()}).toString();console.log("\ud83d\udd17 Auth URL:",r);const a=(await new Promise((e,o)=>{chrome.identity.launchWebAuthFlow({url:r,interactive:!0},s=>{chrome.runtime.lastError?(console.error("\u274c Chrome runtime error:",chrome.runtime.lastError),o(new Error(chrome.runtime.lastError.message||"Error de autorizaci\xf3n"))):s?(console.log("\u2705 Response URL recibida:",s),e(s)):o(new Error("No se recibi\xf3 URL de respuesta"))})})).split("#")[1];if(!a)throw new Error("No se encontr\xf3 fragmento en la URL de respuesta");const i=new URLSearchParams(a),c=i.get("access_token"),l=i.get("error");if(l)throw new Error(`Error de OAuth: ${l} - ${i.get("error_description")||"Error desconocido"}`);if(!c)throw new Error("No se pudo obtener el token de acceso");console.log("\u2705 Access token obtenido exitosamente");const d=i.get("expires_in")||"3600",u=Date.now()+1e3*parseInt(d);if(chrome&&chrome.storage)try{await new Promise((e,o)=>{chrome.storage.local.set({accessToken:c,tokenExpiry:u},()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message)):e()})}),console.log("\u2705 Token guardado en almacenamiento local de Chrome")}catch(o){console.warn("\u26a0\ufe0f No se pudo guardar el token en almacenamiento local:",o)}console.log("\ud83d\udc64 Obteniendo informaci\xf3n del usuario...");const g=await fetch(`https://www.googleapis.com/oauth2/v2/userinfo?access_token=${c}`);if(!g.ok)throw new Error(`Error al obtener informaci\xf3n del usuario: ${g.status}`);const h=await g.json();console.log("\u2705 Informaci\xf3n del usuario obtenida:",h),console.log("\ud83d\udd0d Verificando permisos de escritura...");try{const e=await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${c}`);if(e.ok){const o=await e.json(),s=o.scope?o.scope.split(" "):[];console.log("\ud83d\udccb Scopes obtenidos:",s);s.includes("https://www.googleapis.com/auth/documents")?console.log("\u2705 Permisos de escritura confirmados"):console.warn("\u26a0\ufe0f No se obtuvieron permisos de escritura completos")}}catch(o){console.warn("\u26a0\ufe0f No se pudo verificar permisos:",o)}return e({isAuthenticated:!0,user:h,accessToken:c,isLoading:!1,error:null}),{success:!0,user:h}}catch(o){return console.error("\u274c Error en login:",o),e({isAuthenticated:!1,user:null,accessToken:null,isLoading:!1,error:o.message}),{success:!1,error:o.message}}},logout:async()=>{e({isLoading:!0});try{const{accessToken:t}=o();if(t)try{await fetch(`https://oauth2.googleapis.com/revoke?token=${t}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(s){console.warn("Error al revocar token:",s)}if(chrome&&chrome.storage)try{await new Promise((e,o)=>{chrome.storage.local.remove(["accessToken","tokenExpiry"],()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message)):e()})}),console.log("\u2705 Token eliminado del almacenamiento local de Chrome")}catch(s){console.warn("\u26a0\ufe0f No se pudo eliminar el token del almacenamiento local:",s)}return e({isAuthenticated:!1,user:null,accessToken:null,refreshToken:null,isLoading:!1,error:null}),{success:!0}}catch(s){return e({isLoading:!1,error:s.message}),{success:!1,error:s.message}}},validateToken:async()=>{const{accessToken:e}=o();if(!e)return!1;try{return(await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${e}`)).ok}catch(s){return!1}},checkTokenPermissions:async()=>{const{accessToken:e}=o();if(!e)return{hasPermissions:!1,error:"No hay token de acceso"};try{const o=await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${e}`);if(!o.ok)return{hasPermissions:!1,error:"Token inv\xe1lido o expirado"};const s=await o.json();console.log("\ud83d\udd0d Informaci\xf3n del token:",s);const t=["https://www.googleapis.com/auth/documents","https://www.googleapis.com/auth/drive.readonly"],n=s.scope?s.scope.split(" "):[];return t.every(e=>n.includes(e))?{hasPermissions:!0,tokenInfo:s,tokenScopes:n}:(console.warn("\u26a0\ufe0f El token no tiene todos los permisos necesarios"),console.log("Scopes requeridos:",t),console.log("Scopes del token:",n),{hasPermissions:!1,error:"El token no tiene permisos para acceder a Google Docs. Es necesario renovar la autenticaci\xf3n.",requiredScopes:t,tokenScopes:n})}catch(s){return console.error("\u274c Error al verificar permisos del token:",s),{hasPermissions:!1,error:s.message}}},renewAuthentication:async()=>(console.log("\ud83d\udd04 Renovando autenticaci\xf3n con permisos completos..."),await o().logout(),await o().login()),clearError:()=>e({error:null}),updateUser:s=>e({user:{...o().user,...s}})}),{name:"franbot-auth-storage",partialize:e=>({isAuthenticated:e.isAuthenticated,user:e.user,accessToken:e.accessToken,refreshToken:e.refreshToken})})),c=(0,r.v)((0,a.Zr)((e,o)=>({currentTab:null,chatHistory:[],isProcessing:!1,settings:{theme:"light",language:"es",autoAnalyze:!0,notifications:!0},setCurrentTab:o=>e({currentTab:o}),getCurrentTabInfo:async()=>{try{const[o]=await chrome.tabs.query({active:!0,currentWindow:!0});return e({currentTab:o}),o}catch(o){return console.error("Error getting current tab:",o),null}},addMessage:o=>{const s={id:Date.now(),timestamp:(new Date).toISOString(),...o};e(e=>({chatHistory:[...e.chatHistory,s]}))},clearChatHistory:()=>e({chatHistory:[]}),updateLastMessage:(o,s)=>{e(e=>({chatHistory:e.chatHistory.map(e=>e.id===o?{...e,...s}:e)}))},setProcessing:o=>e({isProcessing:o}),updateSettings:o=>{e(e=>({settings:{...e.settings,...o}}))},resetSettings:()=>{e({settings:{theme:"light",language:"es",autoAnalyze:!0,notifications:!0}})},analyzeCurrentPage:async()=>{e({isProcessing:!0});try{const s=await o().getCurrentTabInfo();if(!s)throw new Error("No se pudo obtener informaci\xf3n de la pesta\xf1a actual");const t=await chrome.tabs.sendMessage(s.id,{action:"extractPageContent"}),n={type:"analysis",sender:"system",content:{url:s.url,title:s.title,...t}};return o().addMessage(n),e({isProcessing:!1}),n}catch(s){console.error("Error analyzing page:",s),e({isProcessing:!1});const t={type:"error",sender:"system",content:{error:s.message}};return o().addMessage(t),t}},exportChatHistory:()=>{const{chatHistory:e}=o(),s=JSON.stringify(e,null,2),t=new Blob([s],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`franbot-chat-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(n)},importChatHistory:o=>{try{const s=JSON.parse(o);return e({chatHistory:s}),{success:!0}}catch(s){return{success:!1,error:s.message}}}}),{name:"franbot-app-storage",partialize:e=>({chatHistory:e.chatHistory,settings:e.settings})})),l={openai:{name:"OpenAI",models:["gpt-4","gpt-4-turbo","gpt-3.5-turbo"]},anthropic:{name:"Anthropic",models:["claude-3-opus","claude-3-sonnet","claude-3-haiku"]},google:{name:"Google",models:["gemini-pro","gemini-pro-vision","gemini-1.5-pro"]}};var d=s(266);const u=function(){const{isAuthenticated:e,user:o,isLoading:s,error:n,login:r,logout:a,validateToken:u,clearError:g,debugOAuth:h}=i(),{currentTab:p,addMessage:m,getCurrentTabInfo:v,clearChatHistory:x}=c(),{aiProvider:f,selectedModel:A,apiKey:w,tempAiProvider:j,tempSelectedModel:b,tempApiKey:I,isValidatingApi:y,apiValidationStatus:C,validationMessage:P,hasUnsavedChanges:k,aiProviders:T,handleTempProviderChange:H,handleTempModelChange:E,handleTempApiKeyChange:N,testApiConnection:S,saveConfiguration:L,resetToDefaults:_}=(()=>{const[e,o]=(0,t.useState)("openai"),[s,n]=(0,t.useState)("gpt-4"),[r,a]=(0,t.useState)(""),[i,c]=(0,t.useState)("openai"),[d,u]=(0,t.useState)("gpt-4"),[g,h]=(0,t.useState)(""),[p,m]=(0,t.useState)(!1),[v,x]=(0,t.useState)(null),[f,A]=(0,t.useState)(""),[w,j]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(()=>{const e="openai",s=l[e].models[0],t=localStorage.getItem("franbot_ai_provider")||e,r=localStorage.getItem("franbot_ai_model")||s,i=localStorage.getItem("franbot_api_key")||"",d=l[t]?t:e,g=l[d].models.includes(r)?r:l[d].models[0];o(d),n(g),a(i),c(d),u(g),h(i),localStorage.getItem("franbot_ai_provider")||localStorage.setItem("franbot_ai_provider",d),localStorage.getItem("franbot_ai_model")||localStorage.setItem("franbot_ai_model",g),localStorage.getItem("franbot_api_key")||localStorage.setItem("franbot_api_key",""),d===t&&g===r||(localStorage.setItem("franbot_ai_provider",d),localStorage.setItem("franbot_ai_model",g))})()},[]);const b=(e,o,s)=>{localStorage.setItem("franbot_ai_provider",e),localStorage.setItem("franbot_ai_model",o),localStorage.setItem("franbot_api_key",s)},I=async()=>{if(console.log("\ud83d\udd0d [API Test] Iniciando validaci\xf3n de API"),console.log("\ud83d\udccb [API Test] Configuraci\xf3n:",{provider:i,model:d,hasApiKey:!!g.trim()}),!g.trim())return console.log("\u274c [API Test] Error: API key vac\xeda"),x("error"),A("Por favor, ingresa una API key v\xe1lida"),!1;m(!0),x(null),A("Probando conexi\xf3n con la API..."),console.log("\u23f3 [API Test] Iniciando prueba de conexi\xf3n...");try{let t;if(console.log(`\ud83d\udd27 [API Test] Configurando proveedor: ${i}`),"openai"===i){console.log("\ud83e\udd16 [API Test] Probando OpenAI API...");const o={model:d,messages:[{role:"user",content:"Responde solo con 'OK' si puedes leer este mensaje."}],max_tokens:10,temperature:0};if(console.log("\ud83d\udce4 [API Test] Enviando request a OpenAI:",o),t=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"},body:JSON.stringify(o)}),console.log("\ud83d\udce5 [API Test] Response status:",t.status),!t.ok){var e;const o=await t.json();throw console.log("\u274c [API Test] Error response:",o),new Error(`OpenAI API Error: ${(null===(e=o.error)||void 0===e?void 0:e.message)||t.statusText}`)}const s=await t.json();if(console.log("\ud83d\udce5 [API Test] OpenAI response:",s),s.choices&&s.choices[0]&&s.choices[0].message)return console.log("\u2705 [API Test] OpenAI prueba exitosa!"),x("success"),A("\u2705 API de OpenAI configurada correctamente"),!0;throw new Error("Respuesta inv\xe1lida de OpenAI API")}if("anthropic"===i){console.log("\ud83e\udde0 [API Test] Probando Anthropic API...");const e={model:d,max_tokens:10,messages:[{role:"user",content:"Responde solo con 'OK' si puedes leer este mensaje."}]};if(console.log("\ud83d\udce4 [API Test] Enviando request a Anthropic:",e),t=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"x-api-key":g,"Content-Type":"application/json","anthropic-version":"2023-06-01"},body:JSON.stringify(e)}),console.log("\ud83d\udce5 [API Test] Response status:",t.status),!t.ok){var o;const e=await t.json();throw console.log("\u274c [API Test] Error response:",e),new Error(`Anthropic API Error: ${(null===(o=e.error)||void 0===o?void 0:o.message)||t.statusText}`)}const s=await t.json();if(console.log("\ud83d\udce5 [API Test] Anthropic response:",s),s.content&&s.content[0]&&s.content[0].text)return console.log("\u2705 [API Test] Anthropic prueba exitosa!"),x("success"),A("\u2705 API de Anthropic configurada correctamente"),!0;throw new Error("Respuesta inv\xe1lida de Anthropic API")}if("google"===i){console.log("\ud83d\udd0d [API Test] Probando Google Gemini API...");const e={contents:[{parts:[{text:"Responde solo con 'OK' si puedes leer este mensaje."}]}],generationConfig:{maxOutputTokens:10,temperature:0}};if(console.log("\ud83d\udce4 [API Test] Enviando request a Google:",e),t=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${d}:generateContent?key=${g}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),console.log("\ud83d\udce5 [API Test] Response status:",t.status),!t.ok){var s;const e=await t.json();throw console.log("\u274c [API Test] Error response:",e),new Error(`Google API Error: ${(null===(s=e.error)||void 0===s?void 0:s.message)||t.statusText}`)}const o=await t.json();if(console.log("\ud83d\udce5 [API Test] Google response:",o),o.candidates&&o.candidates[0]&&o.candidates[0].content)return console.log("\u2705 [API Test] Google prueba exitosa!"),x("success"),A("\u2705 API de Google configurada correctamente"),!0;throw new Error("Respuesta inv\xe1lida de Google API")}}catch(t){return console.error("\u274c [API Test] Error durante la prueba:",t),console.log("\ud83d\udd0d [API Test] Detalles del error:",{message:t.message,name:t.name}),x("error"),t.message.includes("401")||t.message.includes("unauthorized")||t.message.includes("invalid_api_key")?(console.log("\ud83d\udd11 [API Test] Error de autenticaci\xf3n detectado"),A("\u274c API key inv\xe1lida o sin permisos")):t.message.includes("404")||t.message.includes("not found")||t.message.includes("model_not_found")?(console.log("\ud83d\udd0d [API Test] Modelo no encontrado"),A("\u274c Modelo no encontrado o no disponible")):t.message.includes("quota")||t.message.includes("limit")||t.message.includes("rate_limit")?(console.log("\ud83d\udcb0 [API Test] L\xedmite de cuota excedido"),A("\u274c L\xedmite de cuota excedido")):t.message.includes("CORS")||t.message.includes("fetch")?(console.log("\ud83c\udf10 [API Test] Error de conexi\xf3n"),A("\u274c Error de conexi\xf3n con la API")):(console.log("\u2753 [API Test] Error desconocido"),A(`\u274c Error: ${t.message}`)),!1}finally{m(!1),console.log("\ud83c\udfc1 [API Test] Finalizando validaci\xf3n de API")}};return{aiProvider:e,selectedModel:s,apiKey:r,tempAiProvider:i,tempSelectedModel:d,tempApiKey:g,isValidatingApi:p,apiValidationStatus:v,validationMessage:f,hasUnsavedChanges:w,aiProviders:l,handleTempProviderChange:e=>{c(e);const o=l[e].models[0];u(o),j(!0),x(null),A("")},handleTempModelChange:e=>{u(e),j(!0),x(null),A("")},handleTempApiKeyChange:e=>{h(e),j(!0),x(null),A("")},testApiConnection:I,saveConfiguration:async()=>{console.log("\ud83d\udcbe [Save Config] Iniciando proceso de guardado"),console.log("\ud83d\udccb [Save Config] Configuraci\xf3n a guardar:",{provider:i,model:d,hasApiKey:!!g.trim()}),await I()?(console.log("\u2705 [Save Config] API validada, guardando configuraci\xf3n..."),o(i),n(d),a(g),b(i,d,g),j(!1),A("\u2705 Configuraci\xf3n guardada exitosamente"),console.log("\ud83d\udcbe [Save Config] Configuraci\xf3n guardada exitosamente en localStorage"),console.log("\ud83d\udccb [Save Config] Estados actualizados:",{provider:i,model:d,hasUnsavedChanges:!1})):console.log("\u274c [Save Config] API no v\xe1lida, no se guard\xf3 la configuraci\xf3n")},resetToDefaults:()=>{const e="openai",s=l[e].models[0];o(e),n(s),a(""),c(e),u(s),h(""),x(null),A(""),j(!1),localStorage.removeItem("franbot_ai_provider"),localStorage.removeItem("franbot_ai_model"),localStorage.removeItem("franbot_api_key"),b(e,s,"")}}})(),[M,V]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{(async()=>{if(e){await u()||a()}await v()})()},[]),(0,t.useEffect)(()=>{(()=>{if(p&&p.url){const e=p.url.includes("docs.google.com/document/")||p.url.includes("docs.google.com/spreadsheets/")||p.url.includes("docs.google.com/presentation/");V(e)}})()},[p]),s?(0,d.jsx)("div",{className:"franbot-container",children:(0,d.jsxs)("div",{className:"loading-container",children:[(0,d.jsx)("div",{className:"loading-spinner",children:(0,d.jsx)("div",{className:"spinner"})}),(0,d.jsxs)("div",{className:"loading-text",children:[(0,d.jsx)("h3",{children:"Franbot Assistant"}),(0,d.jsx)("p",{children:"Iniciando tu asistente inteligente..."})]})]})}):(0,d.jsx)("div",{className:"franbot-container",children:M?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"franbot-header",children:(0,d.jsxs)("div",{className:"header-content",children:[(0,d.jsxs)("div",{className:"brand",children:[(0,d.jsx)("div",{className:"brand-icon",children:(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V19C3 20.1 3.9 21 5 21H11V19H5V3H13V9H21ZM14 10V12H16V10H14ZM16 14H14V16H16V14ZM20 15L18 17H22L20 15ZM20 10V8L18 10H22L20 10Z"})})}),(0,d.jsxs)("div",{className:"brand-text",children:[(0,d.jsx)("h1",{children:"Franbot"}),(0,d.jsx)("span",{children:"AI Assistant"})]})]}),(0,d.jsx)("div",{className:"header-actions",children:e?(0,d.jsxs)("div",{className:"user-profile",children:[(0,d.jsx)("img",{src:null===o||void 0===o?void 0:o.picture,alt:null===o||void 0===o?void 0:o.name,className:"user-avatar"}),(0,d.jsxs)("div",{className:"user-info",children:[(0,d.jsx)("span",{className:"user-name",children:null===o||void 0===o?void 0:o.name}),(0,d.jsx)("span",{className:"user-status",children:"Conectado"})]}),(0,d.jsx)("button",{onClick:async()=>{await a(),x(),m({text:"Has cerrado sesi\xf3n. Algunas funciones estar\xe1n limitadas hasta que vuelvas a iniciar sesi\xf3n.",sender:"bot",type:"info"})},className:"logout-btn",title:"Cerrar sesi\xf3n",children:(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z"})})})]}):(0,d.jsxs)("div",{className:"auth-actions",children:[(0,d.jsxs)("button",{onClick:async()=>{g();const e=await r();e.success&&m({text:`\xa1Hola ${e.user.name}! Bienvenido a Franbot. Ahora puedes usar todas las funciones avanzadas.`,sender:"bot",type:"welcome"})},className:"login-btn",children:[(0,d.jsxs)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[(0,d.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,d.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,d.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,d.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Iniciar con Google"]}),(0,d.jsx)("button",{onClick:async()=>{m({text:"\ud83d\udd0d Iniciando diagn\xf3stico OAuth...",sender:"bot",type:"info"});const e=await h();if(e.success){let o=`\u2705 Debug OAuth exitoso!\n\n\ud83d\udccb Informaci\xf3n:\n- Extension ID: ${e.extensionId}\n- Client ID: ${e.clientId}\n- M\xe9todo: ${e.method}`;"getAuthToken"===e.method?o+="\n- Token obtenido: "+(e.token?"S\xed":"No"):"launchWebAuthFlow"===e.method&&(o+="\n- Response URL: "+(e.responseUrl?"S\xed":"No"),o+=`\n- Auth URL: ${e.authUrl}`),m({text:o,sender:"bot",type:"success"})}else{let o=`\u274c Debug OAuth fall\xf3:\n\n\ud83d\udd0d Informaci\xf3n de debug:\n- Extension ID: ${e.extensionId||"No disponible"}\n- Client ID: ${e.clientId||"No disponible"}\n- M\xe9todo: ${e.method||"No especificado"}\n- Error: ${e.error}`;e.authUrl&&(o+=`\n- Auth URL: ${e.authUrl}`),o+="\n\n\ud83d\udca1 Pasos siguientes:\n1. Verifica la configuraci\xf3n en Google Cloud Console\n2. Aseg\xfarate de que el Extension ID est\xe9 correcto\n3. Recarga la extensi\xf3n y vuelve a intentar",m({text:o,sender:"bot",type:"error"})}},className:"debug-btn",title:"Debug OAuth",children:(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"})})})]})})]})}),n&&(0,d.jsxs)("div",{className:"error-banner",children:[(0,d.jsxs)("div",{className:"error-content",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"error-icon",children:(0,d.jsx)("path",{d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})}),(0,d.jsx)("span",{children:n})]}),(0,d.jsx)("button",{onClick:g,className:"error-close",children:(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),(0,d.jsx)("div",{className:"main-content",children:(0,d.jsxs)("div",{className:"settings-section",children:[(0,d.jsxs)("div",{className:"settings-group",children:[(0,d.jsx)("h3",{children:"Configuraci\xf3n de IA"}),(0,d.jsxs)("div",{className:"setting-item",children:[(0,d.jsx)("label",{htmlFor:"ai-provider",children:"Proveedor de IA"}),(0,d.jsxs)("select",{id:"ai-provider",className:"setting-select",value:j,onChange:e=>H(e.target.value),children:[(0,d.jsx)("option",{value:"openai",children:"OpenAI"}),(0,d.jsx)("option",{value:"anthropic",children:"Anthropic"}),(0,d.jsx)("option",{value:"google",children:"Google"})]})]}),(0,d.jsxs)("div",{className:"setting-item",children:[(0,d.jsx)("label",{htmlFor:"ai-model",children:"Modelo"}),(0,d.jsx)("select",{id:"ai-model",className:"setting-select",value:b,onChange:e=>E(e.target.value),children:T[j].models.map(e=>(0,d.jsx)("option",{value:e,children:e},e))})]}),(0,d.jsxs)("div",{className:"setting-item",children:[(0,d.jsx)("label",{htmlFor:"api-key",children:"API Key"}),(0,d.jsxs)("div",{className:"api-key-container",children:[(0,d.jsx)("input",{id:"api-key",type:"password",className:"setting-input api-key-input",placeholder:`Ingresa tu API key de ${T[j].name}`,value:I,onChange:e=>N(e.target.value)}),(0,d.jsx)("div",{className:"api-key-status",children:"success"===C?(0,d.jsxs)("span",{className:"status-configured",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})}),"Validado"]}):"error"===C?(0,d.jsxs)("span",{className:"status-error",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})}),"Error"]}):I?(0,d.jsxs)("span",{className:"status-pending",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6Z"})}),"Pendiente"]}):(0,d.jsxs)("span",{className:"status-missing",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})}),"Requerido"]})})]}),(0,d.jsx)("small",{className:"setting-help",children:"Tu API key se almacena localmente y nunca se comparte."})]}),P&&(0,d.jsx)("div",{className:`validation-message ${C}`,children:P}),(0,d.jsxs)("div",{className:"setting-actions",children:[(0,d.jsx)("button",{onClick:L,className:"save-btn "+(k?"has-changes":""),disabled:y||!I.trim(),title:"Probar API y guardar configuraci\xf3n",children:y?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"spinning",children:(0,d.jsx)("path",{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"})}),"Probando..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})}),k?"Probar y Guardar":"Configuraci\xf3n Guardada"]})}),(0,d.jsxs)("button",{onClick:_,className:"reset-btn",title:"Restaurar configuraci\xf3n por defecto",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.5L7,5.5L12,0.5V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z"})}),"Restaurar por defecto"]})]})]}),(0,d.jsxs)("div",{className:"settings-group",children:[(0,d.jsx)("h3",{children:"Privacidad"}),(0,d.jsx)("div",{className:"setting-item",children:(0,d.jsxs)("label",{children:[(0,d.jsx)("input",{type:"checkbox",defaultChecked:!0}),"Enviar datos de errores"]})})]}),(0,d.jsxs)("div",{className:"settings-group",children:[(0,d.jsx)("h3",{children:"Acerca de"}),(0,d.jsxs)("div",{className:"about-info",children:[(0,d.jsx)("p",{children:(0,d.jsx)("strong",{children:"Franbot Assistant"})}),(0,d.jsx)("p",{children:"Versi\xf3n 1.0.0"}),(0,d.jsx)("p",{children:"Tu asistente inteligente para Google Docs"})]})]})]})})]}):(0,d.jsx)("div",{className:"google-docs-required",children:(0,d.jsxs)("div",{className:"restriction-content",children:[(0,d.jsx)("div",{className:"restriction-icon",children:(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})})}),(0,d.jsx)("h2",{children:"Franbot Assistant"}),(0,d.jsx)("p",{children:"Esta extensi\xf3n solo puede ser utilizada en Google Docs."}),(0,d.jsx)("p",{children:"Por favor, abre un documento de Google Docs, Sheets o Presentations para usar Franbot."}),(0,d.jsxs)("div",{className:"supported-apps",children:[(0,d.jsxs)("div",{className:"app-item",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})}),(0,d.jsx)("span",{children:"Google Docs"})]}),(0,d.jsxs)("div",{className:"app-item",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3M19,19H5V5H19V19M7,7H17V9H7V7M7,11H17V13H7V11M7,15H14V17H7V15Z"})}),(0,d.jsx)("span",{children:"Google Sheets"})]}),(0,d.jsxs)("div",{className:"app-item",children:[(0,d.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3M19,19H5V5H19V19M17,12H7V10H17V12Z"})}),(0,d.jsx)("span",{children:"Google Presentations"})]})]})]})})})},g=e=>{e&&e instanceof Function&&s.e(96).then(s.bind(s,902)).then(o=>{let{getCLS:s,getFID:t,getFCP:n,getLCP:r,getTTFB:a}=o;s(e),t(e),n(e),r(e),a(e)})};n.createRoot(document.getElementById("root")).render((0,d.jsx)(t.StrictMode,{children:(0,d.jsx)(u,{})})),g()}},o={};function s(t){var n=o[t];if(void 0!==n)return n.exports;var r=o[t]={exports:{}};return e[t](r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(o,t,n,r)=>{if(!t){var a=1/0;for(d=0;d<e.length;d++){t=e[d][0],n=e[d][1],r=e[d][2];for(var i=!0,c=0;c<t.length;c++)(!1&r||a>=r)&&Object.keys(s.O).every(e=>s.O[e](t[c]))?t.splice(c--,1):(i=!1,r<a&&(a=r));if(i){e.splice(d--,1);var l=n();void 0!==l&&(o=l)}}return o}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[t,n,r]}})(),s.d=(e,o)=>{for(var t in o)s.o(o,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},s.e=()=>Promise.resolve(),s.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};s.O.j=o=>0===e[o];var o=(o,t)=>{var n,r,a=t[0],i=t[1],c=t[2],l=0;if(a.some(o=>0!==e[o])){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(c)var d=c(s)}for(o&&o(t);l<a.length;l++)r=a[l],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},t=self.webpackChunkfranbot_extension=self.webpackChunkfranbot_extension||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))})();var t=s.O(void 0,[96],()=>s(551));t=s.O(t)})();
//# sourceMappingURL=main.8af4f6cb.js.map